---
title: DOCX Conversion REST API
meta:
    title: Conversion REST API | Tiptap Conversion
    description: Learn how to integrate import and export functionality via REST API
    category: Conversion
---

import { Callout } from '@/components/ui/Callout'
import { CodeDemo } from '@/components/CodeDemo'


The `DOCX` document conversion API supports conversion from and to Tiptap’s `JSON` format.

<Callout title="Review the postman collection" variant="hint">
    You can also experiment with the Document Conversion API by heading over to our [Postman
    Collection](https://www.postman.com/docking-module-explorer-14290287/workspace/tiptap-collaboration-public/collection/33042171-cc186a66-df41-4df8-9c6e-e91b20deffe5?action=share&creator=32651125).
</Callout>


## Import DOCX API endpoint

`POST /import-docx`

The `/import-docx` endpoint converts `docx` files into Tiptap’s JSON format. Users can POST documents to this endpoint and use various parameters to customize how different document elements are handled during the conversion process.

### Example (cURL)
```bash
curl -X POST "https://api.tiptap.dev/v1/import-docx" \
-H "Authorization: Bearer YOUR_TOKEN" \
-H "X-App-Id: YOUR_APP_ID" \
-F "file=@/path/to/your/file.docx" \
-F "imageUploadCallbackUrl=https://your-image-upload-endpoint.com" \
-F "promisemirrorNodes={\"nodeKey\":\"nodeValue\"}" \
-F "prosemirrorMarks={\"markKey\":\"markValue\"}"
```

### Required headers

| Name            | Description                                                                                                                                     |
| --------------- | ----------------------------------------------------------------------------------------------------------------------------------------------- |
| `Authorization` | The JWT token to authenticate the request. Example: `Bearer your-jwt-token`                                                                     |
| `X-App-Id`      | The Convert App-ID from the Collaboration settings page: [https://cloud.tiptap.dev/convert-settings](https://cloud.tiptap.dev/convert-settings) |

### Body

| Name                     | Type     | Description                                                                                                                  |
| ------------------------ | -------- | ---------------------------------------------------------------------------------------------------------------------------- |
| `file`                   | `File`   | The file to convert                                                                                                          |
| `imageUploadCallbackUrl` | `string` | The callback endpoint to upload images that were encountered within the uploaded document, [see more info](#image-uploading) |
| `prosemirrorNodes`       | `Object string` | Custom node mapping for the conversion, [see more info](/conversion/import-export/docx/custom-node-conversion).       |
| `prosemirrorMarks`       | `Object string` | Custom mark mapping for the conversion, [see more info](/conversion/import-export/docx/custom-mark-conversion)        |

### Custom node and mark mapping

You can override the default `node/mark` types used during import by specifying them in the body of your request within `prosemirrorNodes` and `prosemirrorMarks` respectively. You would need to provide these if your editor uses custom `nodes/marks` and you want the imported `JSON` to use those.

For example, if your schema uses a custom node type called `textBlock` instead of the default paragraph, you can include `"{\"paragraph\":\"textBlock\"}"` in the request body.

You can similarly adjust headings, lists, marks like bold or italic, and more.

#### Default nodes

| Name             | Description                                                          |
| ---------------- | -------------------------------------------------------------------- |
| `paragraph`      | Defines which prosemirror type is used for paragraph conversion      |
| `heading`        | Defines which prosemirror type is used for heading conversion        |
| `blockquote`     | Defines which prosemirror type is used for blockquote conversion     |
| `codeblock`      | Defines which prosemirror type is used for codeblock conversion      |
| `bulletlist`     | Defines which prosemirror type is used for bulletList conversion     |
| `orderedlist`    | Defines which prosemirror type is used for orderedList conversion    |
| `listitem`       | Defines which prosemirror type is used for listItem conversion       |
| `hardbreak`      | Defines which prosemirror type is used for hardbreak conversion      |
| `horizontalrule` | Defines which prosemirror type is used for horizontalRule conversion |
| `table`          | Defines which prosemirror type is used for table conversion          |
| `tablecell`      | Defines which prosemirror type is used for tableCell conversion      |
| `tableheader`    | Defines which prosemirror type is used for tableHeader conversion    |
| `tablerow`       | Defines which prosemirror type is used for tableRow conversion       |
| `image`          | Defines which prosemirror mark is used for image conversion          |

#### Default marks

| Name             | Description                                                          |
| ---------------- | -------------------------------------------------------------------- |
| `bold`           | Defines which prosemirror mark is used for bold conversion           |
| `italic`         | Defines which prosemirror mark is used for italic conversion         |
| `underline`      | Defines which prosemirror mark is used for underline conversion      |
| `strikethrough`  | Defines which prosemirror mark is used for strikethrough conversion  |
| `link`           | Defines which prosemirror mark is used for link conversion           |
| `code`           | Defines which prosemirror mark is used for code conversion           |


## Import API endpoint

<Callout title="DOCX Import" variant="info">
    The `/import` endpoint is used to convert files to Tiptap JSON. But this endpoint does not support the new `DOCX` conversion features like custom node, mark mapping, document style overrides and other new features.<br /><br />If you need to convert custom nodes, or marks, or `docx` style overrides, use the [/import-docx](#import-docx-api-endpoint) endpoint instead.
</Callout>

`POST /import`

The `/import` endpoint enables the conversion of `docx` files into Tiptap’s JSON format. Users can POST documents to this endpoint and use various parameters to customize how different document elements are handled during the conversion process.

### Example (cURL)
 ```bash
 curl -X POST "https://api.tiptap.dev/v1/import?paragraph=textBlock" \
   -H "Authorization: Bearer <your-jwt-token>" \
   -H "X-App-Id: <your-app-id>" \
   -F "file=@/path/to/document.docx"
 ```
In this example, the request uploads a DOCX file and specifies that paragraphs should be mapped to a node type textBlock instead of the default paragraph.

### Required headers

| Name            | Description                                                                                                                                     |
| --------------- | ----------------------------------------------------------------------------------------------------------------------------------------------- |
| `Authorization` | The JWT token to authenticate the request. Example: `Bearer your-jwt-token`                                                                     |
| `X-App-Id`      | The Convert App-ID from the Collaboration settings page: [https://cloud.tiptap.dev/convert-settings](https://cloud.tiptap.dev/convert-settings) |

### Body

| Name                     | Type     | Description                                                                                                                  |
| ------------------------ | -------- | ---------------------------------------------------------------------------------------------------------------------------- |
| `file`                   | `File`   | The file to convert                                                                                                          |
| `imageUploadCallbackUrl` | `string` | The callback endpoint to upload images that were encountered within the uploaded document, [see more info](#image-uploading) |

## Export API endpoint
`POST /export`

The `/export` endpoint converts Tiptap documents back into the `docx` format.

### Required headers

| Name            | Description                                                                                                                                     |
| --------------- | ----------------------------------------------------------------------------------------------------------------------------------------------- |
| `Authorization` | The JWT token to authenticate the request. Example: `Bearer your-jwt-token`                                                                     |
| `X-App-Id`      | The Convert App-ID from the Collaboration settings page: [https://cloud.tiptap.dev/convert-settings](https://cloud.tiptap.dev/convert-settings) |

### Body

| Name      | Type     | Description                                |
|-----------|----------|--------------------------------------------|
| `content` | `Object` | The Tiptap document                        |
| `format`  | `string` | The format to convert to, should be `docx` |



### Custom node and mark mapping

<Callout title="Support for `/import` and `/export` only" variant="info">
    This part of the documentation only applies to the `/import` and `/export` endpoints, it does not apply to `/import-docx` endpoint.
</Callout>

You can override the default node/mark types used during import or export by specifying them as query parameters. You would need to provide these if your editor uses custom nodes/marks and you want the imported JSON to use those.

For example, if your schema uses a custom node type called textBlock instead of the default paragraph, you can include `?paragraph=textBlock` in the request URL.

You can similarly adjust headings, lists, marks like bold or italic, and more.

<Callout title="Convert custom nodes" variant="hint">
    The REST API can only remap these standard nodes and marks to new names. If you want to define how fully custom nodes should appear in a Word (DOCX) file, you must use the Editor extension and [configure custom node](/conversion/import-export/docx/custom-node-conversion) conversion.
</Callout>

| Name             | Default          | Description                                                          |
| ---------------- | ---------------- | -------------------------------------------------------------------- |
| `paragraph`      | `paragraph`      | Defines which prosemirror type is used for paragraph conversion      |
| `heading`        | `heading`        | Defines which prosemirror type is used for heading conversion        |
| `blockquote`     | `blockquote`     | Defines which prosemirror type is used for blockquote conversion     |
| `codeblock`      | `codeblock`      | Defines which prosemirror type is used for codeblock conversion      |
| `bulletlist`     | `bulletlist`     | Defines which prosemirror type is used for bulletList conversion     |
| `orderedlist`    | `orderedlist`    | Defines which prosemirror type is used for orderedList conversion    |
| `listitem`       | `listitem`       | Defines which prosemirror type is used for listItem conversion       |
| `hardbreak`      | `hardbreak`      | Defines which prosemirror type is used for hardbreak conversion      |
| `horizontalrule` | `horizontalrule` | Defines which prosemirror type is used for horizontalRule conversion |
| `table`          | `table`          | Defines which prosemirror type is used for table conversion          |
| `tablecell`      | `tablecell`      | Defines which prosemirror type is used for tableCell conversion      |
| `tableheader`    | `tableheader`    | Defines which prosemirror type is used for tableHeader conversion    |
| `tablerow`       | `tablerow`       | Defines which prosemirror type is used for tableRow conversion       |
| `bold`           | `bold`           | Defines which prosemirror mark is used for bold conversion           |
| `italic`         | `italic`         | Defines which prosemirror mark is used for italic conversion         |
| `underline`      | `underline`      | Defines which prosemirror mark is used for underline conversion      |
| `strikethrough`  | `strike`         | Defines which prosemirror mark is used for strikethrough conversion  |
| `link`           | `link`           | Defines which prosemirror mark is used for link conversion           |
| `code`           | `code`           | Defines which prosemirror mark is used for code conversion           |
| `image`          | `image`          | Defines which prosemirror mark is used for image conversion          |
