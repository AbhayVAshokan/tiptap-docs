---
title: Import & Export documents with Tiptap
meta:
  title: Import & export | Tiptap Collaboration
  description: Use Tiptap to import & export documents from docx, odt or markdown to Tiptap
  category: Collaboration
---

import { Callout } from '@/components/ui/Callout'
import { CodeDemo } from '@/components/CodeDemo'

Import and export documents from various formats like docx, odt, and markdown and convert them to and from Tiptap's JSON format.

<Callout title="Beta release" variant="hint">
    This extension is accessible to anyone with a Tiptap account. To install the extension you need access to our [private registry](/guides/pro-extensions), set this up first.
</Callout>

<CodeDemo isPro path="/Extensions/ImportExport" />

## Authenticate on your server

JWT, or JSON Web Token, is a compact, URL-safe means of representing claims to be transferred between two parties. The information in a JWT is digitally signed using a cryptographic algorithm to ensure that the claims cannot be altered after the token is issued.

<Callout title="Authentication" variant="hint">
    Make sure to use the Auth key from the [Convert settings](https://cloud.tiptap.dev/convert-settings) page. Other Tiptap feature authentications cannot be used.
</Callout>

### Create a static JWT for testing

For testing purposes, you might not want to set up a complete backend system to generate JWTs. In such cases, using online tools like http://jwtbuilder.jamiekurtz.com/ can be a quick workaround. These tools allow you to create a JWT by inputting the necessary payload and signing it with a secret key.

When using these tools, ensure that the "Key" field is replaced with the secret key from your [Convert settings](https://cloud.tiptap.dev/convert-settings) page. You don’t need to change any other information.

<Callout title="Only for testing" variant="warning">
    Remember, this approach is only recommended for testing due to security risks associated with exposing your secret key.
</Callout>

### Generate JWTs server side

For production-level applications, generating JWTs on the server side is a necessity to maintain security. Exposing your secret key in client-side code would compromise the security of your application. Here’s an example using NodeJS for creating JWTs server-side:

```bash
npm install jsonwebtoken
```

```js
import jsonwebtoken from 'jsonwebtoken'

const payload = {
  // The payload contains claims like the user ID, which can be used to identify the user and their permissions.
  userId: 'user123',
}

// The 'sign' method creates the JWT, with the payload and your secret key as inputs.
const jwt = jsonwebtoken.sign(payload, 'your_secret_key_here')
// The resulting JWT is used for authentication in API requests, ensuring secure access.
// Important: Never expose your secret key in client-side code!
```

This JWT should be incorporated into API requests within the token field of your authentication provider, safeguarding user sessions and data access.

To fully integrate JWT into your application, consider setting up a dedicated server or API endpoint, such as `GET /getConvertToken`. This endpoint would dynamically generate JWTs based on a secret stored securely on the server and user-specific information, like document access permissions.

This setup not only increases security but also provides a scalable solution for managing user sessions and permissions in your collaborative application.

Ensure the secret key is stored as an environment variable on the server, or define it directly in the server code. Avoid sending it from the client side.

## Set up the client-side

Before we can start import & exporting documents, we need to set up the extension. The extension will handle all requests and responses to the convert API & will handle content insertions and downloads.

### Install the extension

To use the convert extension, you need to install the `@tiptap-pro/extension-import-export` package:

```bash
npm i @tiptap-pro/extension-import-export
```

### Configure the extension

```js
// Start with importing the extension
import { ImportExport } from '@tiptap/extension-import-export'

const editor = new Editor({
  // ...
  extensions: [
    // ...
    ImportExport.Configure({
      // The Convert App-ID from the Collaboration settings page: https://cloud.tiptap.dev/convert-settings
      appId: 'your-app-id',

      // The JWT token you generated in the previous step
      token: 'your-jwt',
    }),
  ],
})
```

## Import your first document

```js
// The most simple way to import a file
// This will import the uploaded file, replace the editor content
// and focus the editor
editor.chain().import({ file }).focus().run()
```

### Customize the import behavior

```js
// You can also use the onImport callback to customize the import behavior
editor
  .chain()
  .import({
    file,
    onImport(context) {
      const { setEditorContent, content, error } = context

      // add error handling
      if (error) {
        showErrorToast({ message: error.message })
      }

      // You could also modify the content before inserting it
      content.doc.content.push({ type: 'paragraph', content: [{ type: 'text', text: 'Hello!' }] })

      // you can change the loading state of your application for example
      isLoading = false

      // make sure you call the setEditorContent function if you want to run
      // the default insertion behavior of the extension
      // setEditorContent()
      // but since we modified the content, we need to do the insertion manually
      editor.commands.setContent(content)
    },
  })
  .focus()
  .run()
```

### Export a document

```js
// Do a simple export to docx
// Supported formats: docx, odt, md and gfm
editor.chain().export({ format: 'docx' }).focus().run()
```

### Customize the export behavior

```js
// You can also use the onExport callback to customize the export behavior
editor.chain().export({
  format: 'docx',
  onExport(context) {
    const { blob, error, download, filename } = context

    // add error handling
    if (error) {
      showErrorToast({ message: error.message })
    }

    // you can change the loading state of your application for example
    isLoading = false

    // you could modify the filename or handle the blob differently here
    // but we will keep them as they are

    // you can trigger a download directly by calling the download method
    download()

    // keep in mind that the download method will only work in the browser
    // and if the blob and filename was changed before must be managed manually
  },
})
```

## Supported formats

### Import

- `docx` - Microsoft Word, Google Docs, OpenOffice, LibreOffice and others
- `odt` - OpenDocument Text format used by OpenOffice, LibreOffice and others
- `rtf` - Rich Text Format used by Microsoft Word, Google Docs and others
- Commonmark `markdown` - Markdown format used by various editors and platforms
- GFM `markdown` - GitHub Flavored Markdown used by GitHub

### Export

- `docx` - Microsoft Word, Google Docs, OpenOffice, LibreOffice and others
- `odt` - OpenDocument Text format used by OpenOffice, LibreOffice and others
- Commonmark `markdown` - Markdown format used by various editors and platforms
- GFM `markdown` - GitHub Flavored Markdown used by GitHub

## Caveats and limitations

- **Custom Node exports** - Exporting custom nodes or marks is not supported as they can't be converted into other format structures
- **Unsupported docx elements on import** - Importing docx files currently does not support page breaks, page headers and footers, horizontal rules or text styles
- **Content added via suggestion mode** - Content added via suggestion mode is not included in the imported prosemirror document
- **Custom docx templates** - Currently it's not possible to use custom docx templates for exporting documents
- **PDF import & export** - Importing and exporting PDF files is not yet supported

We're continuously working on improving the import & export extension, so if you have any feedback or feature requests, please let us know!

## More information

- [Extension API](/collaboration/documents/import-export/extension-api)
- [API Reference](/collaboration/documents/import-export/api)
